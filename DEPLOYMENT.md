
# Deploying OneRing

This document assumes that you have created an Azure Web App which will be used
to host OneRing. For instructions on creating a Web App, see our README.md
file.

Deployment of OneRing proper is handled through a process called ["Local Git Deployment to Azure App Service"](https://docs.microsoft.com/en-us/azure/app-service/app-service-deploy-local-git).

## Ensure the correct folder is being deployed

Since this OneRing repository is about to become a multi-project repository, we
need to [add a file to the repository indicating that we want to deploy OneRing](https://github.com/projectkudu/kudu/wiki/Customizing-deployments#deploying-a-specific-folder-for-a-node-php-or-aspnet-site).
The way that we do this is by adding a `.deployment` file to the root of our
repository with the following contents:

    [config]
    project = OneRing

This file may already exist in our repository, but if it doesn't, it'll need to
be created. Note also that the "OneRing" name indicates the folder with the
project to be deployed; if the name of the folder with the OneRing project
changes, then this configuration value will need to change as well.

Once this file is committed, we're all set to configure our git remote.

## Enable "Local Git Repository" as deployment source in Azure

[See the Azure documentation for information.](https://docs.microsoft.com/en-us/azure/app-service/app-service-deploy-local-git#Step3)

## Add the new remote to your local git repo

In the git repository on your local computer, [add the remote generated by Azure:](https://docs.microsoft.com/en-us/azure/app-service/app-service-deploy-local-git#Step4)

    git remote add azure https://<username>@localgitdeployment.scm.azurewebsites.net:443/localgitdeployment.git

## Configure which branch to deploy

Fill in here how to configure which branch to deploy (if need be).

## Uploading `appsettings.json`

You shouldn't need to upload you own `appsettings.json`, as those variables
should be set with what are called App Settings (environment variables) within
the Azure interface for your web app. However, if those App Settings are not
working and the filler values from `appsettings.json` are being used, you can
push up a version with the correct values without committing that file to the
repository.

To do this, download the publish profile for your web app. Open it up in a text
editor and find the generated username, password, and remote URI for publishing
you application. Then, use those credentials to connect to that FTP server and
in the `wwwroot` folder, upload your correct `appsettings.json` file,
overwriting the version with dummy values.
